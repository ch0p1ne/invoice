<UserControl x:Class="invoice.Views.CreateFactureOne"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:invoice.Views" 
             xmlns:converters="clr-namespace:invoice.Utilities.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800"
             Style="{StaticResource Page_Style}">
    
    <UserControl.Resources>
        <converters:BoolToInvertValue x:Key="BoolToInvertValueConverter" />
        <converters:StringToDateOnly x:Key="StringToDateOnlyConverter" />

        <Style  x:Key="txtIsBinder" TargetType="TextBox">
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Background" Value="{StaticResource LightGray}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Height" Value="30" />
            <Setter Property="Padding" Value="8,6" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Grid>
                            <Border x:Name="PART_Border"
						            Background="{TemplateBinding Background}"
						            CornerRadius="2"
						            BorderThickness="2"
						            BorderBrush="LightBlue"
						            SnapsToDevicePixels="True">
                                <ScrollViewer x:Name="PART_ContentHost" Margin="4,0"/>
                            </Border>

                            <!-- underline -->
                            <Border x:Name="Underline"
						            Height="1"
						            VerticalAlignment="Bottom"
						            Background="{StaticResource LightGray}"
						            CornerRadius="1"
						            Margin="2,0,2,2"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Underline" Property="Background" Value="{StaticResource PrimaryBlue}"/>
                                <Setter TargetName="Underline" Property="Height" Value="1"/>
                                <Setter TargetName="PART_Border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect Color="#22000000" BlurRadius="8" ShadowDepth="0"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="IsReadOnly" Value="True" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="14" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style  x:Key="datePickerIsBinder" TargetType="DatePicker">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style  x:Key="cbxIsBinder" TargetType="ComboBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderThickness" Value="4" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style  x:Key="checkBoxIsBinder" TargetType="CheckBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderThickness" Value="3" />
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />

        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" HorizontalAlignment="Left" VerticalAlignment="Center">
            <WrapPanel Margin="130,30,0,0">
                <Border Height="35"
                        Width="5"
                        Background="#404040">

                </Border>
                <TextBlock Text="Identité du Patient" VerticalAlignment="Center"
                           FontSize="25"
                           Margin="20,0,0,0"
                           FontFamily="{StaticResource fontSen}"/>
            </WrapPanel>
        </StackPanel>

        
        <WrapPanel Grid.Row="1" 
                   HorizontalAlignment="Right" 
                   VerticalAlignment="Top"
                   Margin="0,0,100,0">

            <Image Source="/Assets/icons/client.png" 
                   Margin="0,0,10,0"
                   Height="24"/>
            <ComboBox IsEditable="True" 
                      Width="245"
                      SelectedItem="{Binding SelectedPatient, Mode=OneWayToSource}"
                      Name="cbxPatient"
                      ItemsSource="{Binding Patients}"
                      MaxDropDownHeight="100"
                      >
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">

                            <Rectangle Fill="LightGreen" Width="4" Height="9" Margin="0,2,5,2" />

                            <StackPanel Orientation="Horizontal">
                                <ContentControl Content="{Binding LastName}"
                                                    Margin="0,0,5,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"/>
                                <ContentControl Content="{Binding FirstName}"
                                                    VerticalAlignment="Center"
                                                    FontSize="14"/>
                            </StackPanel>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </WrapPanel>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Top"
            Margin="155,35,0,0">
                <WrapPanel Orientation="Vertical">
                    <TextBlock Text="Nom :"  
                           Style="{StaticResource FieldLabel}"/>
                    <TextBox Name="txtNom" Width="250"
                             Background="#fdfffc" 
                             Text="{Binding LastName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" 
                             Style="{StaticResource txtIsBinder}"/>

                </WrapPanel>
                <WrapPanel Margin="0,0,0,15" Orientation="Vertical">
                    <TextBlock Text="Prenom :"  
                               Style="{StaticResource FieldLabel}"/>
                    <TextBox Name="txtPrenom" Width="250"
                             Background="#fdfffc" 
                             Text="{Binding FirstName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             VerticalAlignment="Center"
                             Style="{StaticResource txtIsBinder}"
                             HorizontalContentAlignment="Left" />
                </WrapPanel>
                <WrapPanel Margin="0,0,0,0">
                    <WrapPanel Orientation="Vertical">
                         <TextBlock Text="Téléphone Principale :"  Style="{StaticResource FieldLabel}"/>
                        <TextBox Name="txtPhone" Width="185" 
                             Background="#fdfffc" 
                             VerticalAlignment="Center"
                             Text="{Binding PhoneNumber1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             HorizontalContentAlignment="Left" 
                             Style="{StaticResource txtIsBinder}"
                             FontWeight="Normal"/>
                    </WrapPanel>

                    <WrapPanel Margin="75,0,0,0" Orientation="Vertical">
                        <TextBlock Text="Téléphone Secondaire :"  Style="{StaticResource FieldLabel}"/>
                        <TextBox Name="txtPhone2" Width="185" 
                             Background="#fdfffc" 
                             VerticalAlignment="Center"
                             Text="{Binding PhoneNumber2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             HorizontalContentAlignment="Left" 
                             Style="{StaticResource txtIsBinder}"
 
                             FontWeight="Normal"/>
                    </WrapPanel>
                </WrapPanel>
                <WrapPanel Margin="0,0,0,15" Orientation="Vertical">
                    <TextBlock Text="Date de Naissance :" Style="{StaticResource FieldLabel}"/>
                    <DatePicker DisplayDateStart="1901-01-01" 
                                DisplayDateEnd="2099-12-31"
                                Width="185"
                                IsTodayHighlighted="True"
                                Style="{StaticResource datePickerIsBinder}"
                                SelectedDate="{Binding DateOfBirth, Mode=TwoWay}"
                                DisplayDate="2020-01-01"
                                Background="Transparent"
                                Padding="8,6"
                                FontSize="12"
                                FontWeight="SemiBold"/>
                </WrapPanel>
                <WrapPanel>
                    <WrapPanel Orientation="Vertical">
                        <TextBlock Text="Email :" Style="{StaticResource FieldLabel}"/>
                        <TextBox Name="txtEmail" Width="185"
                             Background="#fdfffc" 
                             Text="{Binding Patient.Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" 
                             Style="{StaticResource txtIsBinder}"
                                 FontWeight="Normal"/>
                    </WrapPanel>
                    
                    <WrapPanel Orientation="Vertical" Margin="75,0,0,0">
                        <TextBlock Text="Adresse :"  Style="{StaticResource FieldLabel}" />
                        <TextBox Name="txtAdress" Width="185"
                             Background="#fdfffc" 
                             VerticalAlignment="Center"
                             Text="{Binding Patient.Address, Mode=TwoWay}"
                                Style="{StaticResource txtIsBinder}"
                             HorizontalContentAlignment="Left" 
                             FontWeight="Normal"/>
                    </WrapPanel>
                </WrapPanel>
            </StackPanel>

            <StackPanel Grid.Column="1" 
                HorizontalAlignment="Left" 
                VerticalAlignment="Bottom"
                        Margin="275,0,0,70"
                >       
                <WrapPanel>
                    <TextBlock Text="Patient Assurée : "  Margin="0,0,10,0"
                               FontSize="14"
                               FontWeight="Bold"/>
                    <CheckBox Style="{StaticResource checkBoxIsBinder}"
                              IsChecked="{Binding IsInsurance, Mode=TwoWay}"/>
                </WrapPanel>
                <WrapPanel Margin="0,25,0,0"  
                           Orientation="Horizontal">
                    <TextBlock Text="Type d'assurance :" 
                                Margin="0,0,15,0" 
                               VerticalAlignment="Top"/>
                    <ComboBox Name="cbxTypeAssur"
                              MaxHeight="22"
                              IsEnabled="{Binding IsInsurance}"
                              ItemsSource="{Binding Assurances}"
                              SelectedItem="{Binding SelectedAssurance, Mode=TwoWay}"
                              MinWidth="75"
                              Style="{StaticResource cbxIsBinder}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Rectangle Fill="LightCoral" Width="4" Height="8" Margin="0,2,5,2" />
                                    <ContentControl Content="{Binding Compagny}"
                                                    VerticalAlignment="Center"
                                                    FontSize="15"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </WrapPanel>
                
                <WrapPanel Margin="0,17,0,0"  Orientation="Vertical">
                    <TextBlock Text="N° de l'assurance :" 
                               Margin="0,0,0,5"/>
                    <TextBox
                             MinWidth="175"
                             VerticalContentAlignment="Center"
                             Padding="10,0"
                             Height="25"
                             IsEnabled="{Binding IsInsurance}"
                             Background="#fdfffc" 
                             Text="{Binding Patient.AssuranceNumber, Mode=TwoWay}"
                             VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" 
                             FontWeight="Normal"
                             Style="{StaticResource txtIsBinder}"/>
                </WrapPanel>
                <WrapPanel Margin="0,15,0,0"  
                            Orientation="Horizontal">
                    <TextBlock Text="Part Assurance :" 
                         Margin="0,0,15,0" 
                        VerticalAlignment="Center"/>

                    <TextBox VerticalContentAlignment="Center" Padding="5,0" 
                             MinWidth="30"
                             MinHeight="25"
                             MaxLength="4"
                             FontWeight="Bold"
                             IsEnabled="{Binding IsInsurance}"
                            Text="{Binding SelectedAssurance.CoveragePercent, StringFormat={}{0:P0}, Mode=OneWay}"
                             Style="{StaticResource txtIsBinder}"/>
                </WrapPanel>
            </StackPanel>
        </Grid>
        
        <StackPanel Grid.Row="2" Margin="170,0,0,50">

            <WrapPanel Name="Pnl1" Orientation="Vertical">
                <TextBlock Text="Agent émetteur" FontSize="14"></TextBlock>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding DataContext.SessionService.User.Account_name, RelativeSource={RelativeSource AncestorType={x:Type Window}}, StringFormat=Mr/Mme {0:f}}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Background" Value="#FFFFFF" />
                                <Setter Property="Padding" Value="100,15" />
                                <Setter Property="FontStyle" Value="Italic" />
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>

            </WrapPanel>


            <!--<WrapPanel Orientation="Vertical" HorizontalAlignment="Right" Margin="0,0,50,10">
                <RadioButton x:Name="rdbFac" GroupName="facChoose" 
                             Content="Facture"
                             ></RadioButton>
                <RadioButton x:Name="rdbCon" GroupName="facChoose" 
                             Content="Consultation"
                             > </RadioButton>
            </WrapPanel>-->

            <WrapPanel VerticalAlignment="Center" 
                        HorizontalAlignment="Right">
                <Button Width="110"
                            IsEnabled="{Binding PatientDefined, Converter={StaticResource BoolToInvertValueConverter}}"
                            Command="{Binding CreatePatientCommand}"
                            CommandParameter="CrudCreateTwo"
                            Height="42"
>
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Horizontal">
                        <TextBlock VerticalAlignment="Center" Text="Ajouter le Patient "/>
                    </StackPanel>
                </Button>
                <Button Style="{StaticResource buttonNextStyle}" 
                        Width="110"
                        Margin="30,0,100,0"
                        IsEnabled="{Binding PatientDefined}"
                        Command="{Binding ChangeCurrentViewCommand}"
                        CommandParameter="CrudCreateTwo"
                        Height="42"
        >
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Horizontal">
                        <TextBlock VerticalAlignment="Center" Text="Suivant "/>
                        <Image Source="/Assets/icons/arrow-right.png"  Height="24"/>
                    </StackPanel>
                </Button>
            </WrapPanel>


        </StackPanel>
    </Grid>
</UserControl>
