<UserControl x:Class="invoice.Views.CreateFactureOne"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:invoice.Views" 
             xmlns:converters="clr-namespace:invoice.Utilities.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    
    <UserControl.Resources>
        <converters:BoolToInvertValue x:Key="BoolToInvertValueConverter" />
        <converters:StringToDateOnly x:Key="StringToDateOnlyConverter" />

        <Style  x:Key="txtIsBinder" TargetType="TextBox">
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Padding" Value="7,2" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="Padding" Value="7,2" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="IsReadOnly" Value="True" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="14" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style  x:Key="datePickerIsBinder" TargetType="DatePicker">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style  x:Key="cbxIsBinder" TargetType="ComboBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderThickness" Value="4" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style  x:Key="checkBoxIsBinder" TargetType="CheckBox">
            <Style.Triggers>
                <DataTrigger Binding="{Binding PatientDefined }" Value="true">
                    <Setter Property="BorderThickness" Value="3" />
                    <Setter Property="BorderBrush" Value="#9ECCA9" />
                    <Setter Property="IsEnabled" Value="False" />
                    <Setter Property="Background" Value="#F0F3EE" />
                    <Setter Property="Foreground" Value="#000000" />
                    <Setter Property="FontSize" Value="15" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />

        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" HorizontalAlignment="Left" VerticalAlignment="Center">
            <WrapPanel Margin="130,30,0,0">
                <Border Height="35"
                        Width="5"
                        Background="#404040">

                </Border>
                <TextBlock Text="Identité du client" VerticalAlignment="Center"
                           FontSize="25"
                           Margin="20,0,0,0"
                           FontFamily="{StaticResource fontSen}"/>
            </WrapPanel>
        </StackPanel>

        
        <WrapPanel Grid.Row="1" 
                   HorizontalAlignment="Right" 
                   VerticalAlignment="Top"
                   Margin="0,0,100,0">

            <Image Source="/Assets/icons/client.png" 
                   Margin="0,0,10,0"
                   Height="24"/>
            <ComboBox IsEditable="True" 
                      MinWidth="100" 
                      SelectedItem="{Binding SelectedPatient, Mode=OneWayToSource}"
                      Name="cbxPatient"
                      ItemsSource="{Binding Patients}"
                      MaxDropDownHeight="75">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Fill="BlueViolet" Width="4" Height="8" Margin="0,2,5,2" />
                            <ContentControl Content="{Binding LastName}"
                                            Margin="0,0,5,0"
                                            VerticalAlignment="Center"
                                            FontSize="15"/>
                            <ContentControl Content="{Binding FirstName}"
                                            VerticalAlignment="Center"
                                            FontSize="15"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </WrapPanel>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Top"
            Margin="155,70,0,0">
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="_Nom :"  
               VerticalAlignment="Center" />
                    <TextBox Name="txtNom" Width="200"  Height="25"
                 Background="#fdfffc" 
                 Text="{Binding Patient.LastName, Mode=TwoWay}"
                 VerticalAlignment="Center"
                 HorizontalContentAlignment="Left" 
                 Margin="15,0,0,0"
                 FontWeight="Normal" 
                 Style="{StaticResource txtIsBinder}"
                 >

                    </TextBox>

                </WrapPanel>
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="_Prenom :"  
               VerticalAlignment="Center" />
                    <TextBox Name="txtPrenom" Width="260"  Height="25"
                 Background="#fdfffc" 
                 Text="{Binding Patient.FirstName, Mode=TwoWay}"
                 VerticalAlignment="Center"
                 Style="{StaticResource txtIsBinder}"
                 HorizontalContentAlignment="Left" 
                 Margin="15,0,0,0"
                 FontWeight="Normal"/>
                </WrapPanel>
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="_Email :" 
               VerticalAlignment="Center" />
                    <TextBox Name="txtEmail" Width="260"  Height="25"
                 Background="#fdfffc" 
                 Text="{Binding Patient.Email, Mode=TwoWay}"
                 VerticalAlignment="Center"
                 HorizontalContentAlignment="Left" 
                 Margin="15,0,0,0"
                 Style="{StaticResource txtIsBinder}"
                 FontWeight="Normal"/>
                </WrapPanel>
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="Telephone mobile :"  
               VerticalAlignment="Center" />
                    <TextBox Name="txtPhone" Width="180"  Height="25"
                 Background="#fdfffc" 
                 VerticalAlignment="Center"
                 Text="{Binding Patient.PhoneNumber, Mode=TwoWay}"
                 HorizontalContentAlignment="Left" 
                 Style="{StaticResource txtIsBinder}"
                 Margin="15,0,0,0"
                 FontWeight="Normal"/>
                </WrapPanel>
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="Adresse :" 
               VerticalAlignment="Center" />
                    <TextBox Name="txtAdress" Width="180"  Height="25"
                 Background="#fdfffc" 
                 VerticalAlignment="Center"
                 Text="{Binding Patient.Address, Mode=TwoWay}"
                    Style="{StaticResource txtIsBinder}"
                 HorizontalContentAlignment="Left" 
                 Margin="15,0,0,0"
                 FontWeight="Normal"/>
                </WrapPanel>
                <WrapPanel Margin="0,0,0,15">
                    <Label Content="Date de Naissance :" 
               VerticalAlignment="Center" />
                    <DatePicker DisplayDateStart="2020-01-01" 
                                DisplayDateEnd="2030-12-31"
                                Margin="15,0,0,0"
                                Style="{StaticResource datePickerIsBinder}"
                                SelectedDate="{Binding Patient.DateOfBirth, Mode=TwoWay}"
                                FontWeight="Normal"/>
                </WrapPanel>
            </StackPanel>

            <StackPanel Grid.Column="1" 
                HorizontalAlignment="Left" 
                VerticalAlignment="Bottom"
                        Margin="275,0,0,70"
                >       
                <WrapPanel>
                    <TextBlock Text="Patient Assurée : "  Margin="0,0,10,0"
                               FontSize="14"
                               FontWeight="Bold"/>
                    <CheckBox Style="{StaticResource checkBoxIsBinder}"
                              IsChecked="{Binding IsInsurance, Mode=TwoWay}"/>
                </WrapPanel>
                <WrapPanel Margin="0,25,0,0"  
                           Orientation="Horizontal">
                    <TextBlock Text="Type d'assurance :" 
                                Margin="0,0,15,0" 
                               VerticalAlignment="Top"/>
                    <ComboBox Name="cbxTypeAssur"
                              MaxHeight="22"
                              IsEnabled="{Binding IsInsurance}"
                              ItemsSource="{Binding Assurances}"
                              SelectedItem="{Binding SelectedAssurance, Mode=TwoWay}"
                              MinWidth="75"
                              Style="{StaticResource cbxIsBinder}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Rectangle Fill="LightCoral" Width="4" Height="8" Margin="0,2,5,2" />
                                    <ContentControl Content="{Binding Compagny}"
                                                    VerticalAlignment="Center"
                                                    FontSize="15"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </WrapPanel>
                
                <WrapPanel Margin="0,17,0,0"  Orientation="Vertical">
                    <TextBlock Text="N° de l'assurance :" 
                               Margin="0,0,0,5"/>
                    <TextBox
                             MinWidth="175"
                             VerticalContentAlignment="Center"
                             Padding="10,0"
                             Height="25"
                             IsEnabled="{Binding IsInsurance}"
                             Background="#fdfffc" 
                             Text="{Binding Patient.AssuranceNumber, Mode=TwoWay}"
                             VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" 
                             FontWeight="Normal"
                             Style="{StaticResource txtIsBinder}"/>
                </WrapPanel>
                <WrapPanel Margin="0,15,0,0"  
                            Orientation="Horizontal">
                    <TextBlock Text="Part Assurance :" 
                         Margin="0,0,15,0" 
                        VerticalAlignment="Center"/>

                    <TextBox VerticalContentAlignment="Center" Padding="5,0" 
                             MinWidth="30"
                             MinHeight="25"
                             MaxLength="4"
                             FontWeight="Bold"
                             IsEnabled="{Binding IsInsurance}"
                            Text="{Binding SelectedAssurance.CoveragePercent, StringFormat={}{0:P0}, Mode=OneWay}"
                             Style="{StaticResource txtIsBinder}"/>
                </WrapPanel>
            </StackPanel>
        </Grid>
        
        <StackPanel Grid.Row="2" Margin="170,0,0,50">

            <WrapPanel Name="Pnl1" Orientation="Vertical">
                <TextBlock Text="Agent émetteur" FontSize="14"></TextBlock>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding DataContext.SessionService.User.Account_name, RelativeSource={RelativeSource AncestorType={x:Type Window}}, StringFormat=Mr/Mme {0:f}}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Background" Value="#FFFFFF" />
                                <Setter Property="Padding" Value="100,15" />
                                <Setter Property="FontStyle" Value="Italic" />
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </StackPanel>

            </WrapPanel>


            <!--<WrapPanel Orientation="Vertical" HorizontalAlignment="Right" Margin="0,0,50,10">
                <RadioButton x:Name="rdbFac" GroupName="facChoose" 
                             Content="Facture"
                             ></RadioButton>
                <RadioButton x:Name="rdbCon" GroupName="facChoose" 
                             Content="Consultation"
                             > </RadioButton>
            </WrapPanel>-->

            <WrapPanel VerticalAlignment="Center" 
                        HorizontalAlignment="Right">
                    <Button Width="110"
                            IsEnabled="{Binding PatientDefined, Converter={StaticResource BoolToInvertValueConverter}}"
                            Command="{Binding CreatePatientCommand}"
                            CommandParameter="CrudCreateTwo"
                            Height="42"
>
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Horizontal">
                        <TextBlock VerticalAlignment="Center" Text="Ajouter le Patient "/>
                    </StackPanel>
                </Button>
                <Button Style="{StaticResource buttonNextStyle}" 
                        Width="110"
                        Margin="30,0,100,0"
                        IsEnabled="{Binding PatientDefined}"
                        Command="{Binding ChangeCurrentViewCommand}"
                        CommandParameter="CrudCreateTwo"
                        Height="42"
        >
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Horizontal">
                        <TextBlock VerticalAlignment="Center" Text="Suivant "/>
                        <Image Source="/Assets/icons/arrow-right.png"  Height="24"/>
                    </StackPanel>
                </Button>
            </WrapPanel>


        </StackPanel>
    </Grid>
</UserControl>
